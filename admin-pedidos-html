<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Painel Admin</title>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<style>
body { font-family:Arial; background:#f4f6f9; padding:20px; }
.card { background:white; padding:15px; margin-bottom:15px; border-radius:8px; box-shadow:0 3px 10px rgba(0,0,0,0.05); }
select { padding:5px; }
</style>
</head>

<body>

<h1>Painel de Pedidos</h1>
<h2>Total Vendido: R$ <span id="totalVendido">0</span></h2>

<div id="lista"></div>

<script>

const firebaseConfig = {
  apiKey: "AIzaSyDAnBNdufwLlMW4bZHK0mUgncmIezNSMTg",
  authDomain: "minha-loja-digital1.firebaseapp.com",
  projectId: "minha-loja-digital1",
  storageBucket: "minha-loja-digital1.firebasestorage.app",
  messagingSenderId: "119834670597",
  appId: "1:119834670597:web:36edb828d7fdded6678e6c"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

function carregarPedidos(){
  db.collection("pedidos").orderBy("data","desc").onSnapshot(snapshot=>{
    const div = document.getElementById("lista");
    div.innerHTML = "";
    let totalGeral = 0;

    snapshot.forEach(doc=>{
      const p = doc.data();
      totalGeral += p.total || 0;

      div.innerHTML += `
        <div class="card">
          <strong>Data:</strong> ${new Date(p.data.seconds*1000).toLocaleString()}<br>
          <strong>Total:</strong> R$ ${p.total}<br>
          <strong>Status:</strong>
          <select onchange="atualizarStatus('${doc.id}', this.value)">
            <option ${p.status=="Novo"?"selected":""}>Novo</option>
            <option ${p.status=="Em andamento"?"selected":""}>Em andamento</option>
            <option ${p.status=="Finalizado"?"selected":""}>Finalizado</option>
          </select>
        </div>
      `;
    });

    document.getElementById("totalVendido").innerText = totalGeral.toFixed(2);
  });
}

function atualizarStatus(id, status){
  db.collection("pedidos").doc(id).update({status: status});
}

carregarPedidos();

</script>

</body>
</html>
